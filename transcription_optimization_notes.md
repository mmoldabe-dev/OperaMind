# Проблемы и решения при ускорении транскрипции

## Проблема 1: Медленная обработка длинных аудиофайлов через Google Speech Recognition
- **Симптом:** При chunked-режиме каждый чанк обрабатывался последовательно, что приводило к долгому ожиданию результата на длинных файлах.
- **Решение:** Внедрена параллельная обработка чанков с помощью ThreadPoolExecutor. Теперь чанки распознаются одновременно в нескольких потоках, что значительно ускоряет транскрипцию.

## Проблема 2: Whisper не использует GPU по умолчанию
- **Симптом:** Даже при наличии GPU транскрипция могла идти только на CPU, что медленно для больших моделей.
- **Решение:** В параметрах WhisperModel теперь можно явно указать device='cuda' через переменную окружения WHISPER_DEVICE. Это позволяет использовать GPU и ускоряет обработку.

## Проблема 3: Блокировка Flask при обработке больших файлов
- **Симптом:** Пока идёт транскрипция, веб-интерфейс "зависает" и пользователь ждёт завершения всей работы.
- **Решение:** (Рекомендация) Вынести транскрипцию в фоновые задачи через Celery или RQ. Это позволит не блокировать основной сервер и обрабатывать несколько файлов параллельно.

## Проблема 4: Ограничения Google API и ошибки сети
- **Симптом:** Иногда Google SR возвращает ошибки или квоты исчерпаны.
- **Решение:** В коде реализованы повторные попытки и fallback на другие движки (Whisper, Vosk).

---

**Если потребуется ускорение других частей или интеграция фоновых задач — см. README или обратитесь к разработчику.**
