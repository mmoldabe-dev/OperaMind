{% extends "base.html" %}

{% block title %}–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ - OperaMind{% endblock %}

{% block content %}
<div style="max-width: 700px; margin: 0 auto;">
    <div class="card">
        <h2 style="margin-bottom: 10px; color: #2c3e50;">üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h2>
        <p style="color: #7f8c8d; margin-bottom: 30px;">
            –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª –∏–ª–∏ –≥–æ—Ç–æ–≤—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é
        </p>
        
    <form id="uploadForm" method="POST" action="{{ url_for('upload_file') }}" enctype="multipart/form-data">
            <div style="margin-bottom: 25px;">
                <label style="display: block; margin-bottom: 12px; font-weight: 600; color: #2c3e50;">
                    üìÅ –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª
                </label>
                <div style="position: relative;">
                    <input type="file" name="file" accept=".mp3,.wav,.m4a,.ogg,.txt" required
                           style="width: 100%; padding: 20px; border: 3px dashed #667eea; border-radius: 12px; background: #f8f9ff; cursor: pointer; font-size: 1rem;"
                           onchange="this.nextElementSibling.textContent = this.files[0]?.name || '–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω'">
                    <p style="margin-top: 10px; color: #667eea; font-weight: 500;">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</p>
                </div>
            </div>
            
            <div style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                <p style="color: #2c3e50; margin-bottom: 10px;"><strong>üéµ –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã:</strong></p>
                <p style="color: #7f8c8d; margin-bottom: 15px;">MP3, WAV, M4A, OGG (–¥–æ 50 –ú–ë)</p>
                <p style="color: #2c3e50; margin-bottom: 10px;"><strong>üìÑ –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã:</strong></p>
                <p style="color: #7f8c8d;">TXT —Å –≥–æ—Ç–æ–≤–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π</p>
            </div>
            
            <button id="submitBtn" type="submit" class="btn" style="width: 100%; padding: 16px; font-size: 1.1rem;">
                üöÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
            </button>
        </form>
    </div>
    
    <div style="margin-top: 30px; text-align: center;">
        <a href="{{ url_for('history') }}" class="btn btn-secondary" style="padding: 14px 30px;">
            üìã –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–æ–∫
        </a>
    </div>
</div>

<div id="progressOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55); backdrop-filter:blur(4px); z-index:999; align-items:center; justify-content:center;">
    <div style="background:white; padding:40px 50px; border-radius:18px; width:420px; box-shadow:0 10px 40px rgba(0,0,0,0.25); text-align:center;">
        <h2 style="margin-bottom:18px; font-size:1.4rem; color:#2c3e50;">‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞</h2>
        <p id="phaseText" style="color:#555; margin-bottom:25px;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        <div style="height:10px; background:#eef2ff; border-radius:6px; overflow:hidden; margin-bottom:25px;">
            <div id="bar" style="height:100%; width:10%; background:linear-gradient(90deg,#667eea,#764ba2); transition:width .6s ease;"> </div>
        </div>
        <p style="font-size:0.75rem; color:#7f8c8d;">–ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.</p>
    </div>
</div>

<script>
    const form = document.getElementById('uploadForm');
    const overlay = document.getElementById('progressOverlay');
    const bar = document.getElementById('bar');
    const phase = document.getElementById('phaseText');
    const submitBtn = document.getElementById('submitBtn');
    if (form) {
        form.addEventListener('submit', () => {
            overlay.style.display = 'flex';
            submitBtn.disabled = true;
            let p = 5;
            phase.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...';
            bar.style.width = p + '%';
            const steps = [
                {t:1500, phase:'–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è...', w:40},
                {t:4000, phase:'–ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞...', w:70},
                {t:7000, phase:'–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞...', w:90},
            ];
            steps.forEach(s => setTimeout(()=>{ phase.textContent = s.phase; bar.style.width = s.w + '%'; }, s.t));
        });
    }
</script>

<div style="margin-top: 50px; max-width: 700px; margin-left: auto; margin-right: auto;">
    <div class="card">
        <h3 style="margin-bottom: 20px; color: #2c3e50;">üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏</h3>
        <div style="display: grid; gap: 20px;">
            <div style="display: flex; gap: 15px; align-items: start;">
                <div style="background: #667eea; color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</div>
                <div>
                    <strong style="color: #2c3e50;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞</strong>
                    <p style="color: #7f8c8d; margin-top: 5px;">–ê—É–¥–∏–æ –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ</p>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; align-items: start;">
                <div style="background: #667eea; color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</div>
                <div>
                    <strong style="color: #2c3e50;">–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è</strong>
                    <p style="color: #7f8c8d; margin-top: 5px;">–ê—É–¥–∏–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ Gemini AI</p>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; align-items: start;">
                <div style="background: #667eea; color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</div>
                <div>
                    <strong style="color: #2c3e50;">–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞</strong>
                    <p style="color: #7f8c8d; margin-top: 5px;">Gemini –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä: —Ç–µ–º–∞, —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –∫–∞—á–µ—Å—Ç–≤–æ, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</p>
                </div>
            </div>

            <div style="display: flex; gap: 15px; align-items: start;">
                <div style="background: #667eea; color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">4</div>
                <div>
                    <strong style="color: #2c3e50;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –æ—Ç—á—ë—Ç</strong>
                    <p style="color: #7f8c8d; margin-top: 5px;">–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}